# 📚 Outlook配置文档索引

本文档提供了所有配置相关文档的快速导航。

---

## 🎯 快速导航

### 新手入门 (推荐按此顺序阅读)

1. **[快速开始.md](./快速开始.md)** ⭐
   - 最快的配置方式
   - 5-10分钟完成配置
   - 包含简化的步骤说明

2. **[配置流程图.md](./配置流程图.md)** 📊
   - 可视化配置流程
   - 帮助理解整体架构
   - 包含故障排除流程

3. **[OUTLOOK_配置指南.md](./OUTLOOK_配置指南.md)** 📖
   - 最详细的配置教程
   - 包含所有细节和截图说明
   - 完整的常见问题解答

---

## 📂 文档分类

### 配置类文档

| 文档名称 | 用途 | 适合人群 |
|---------|------|---------|
| **快速开始.md** | 快速配置指南 | 想要立即开始的用户 |
| **OUTLOOK_配置指南.md** | 详细配置教程 | 需要详细说明的用户 |
| **配置流程图.md** | 流程可视化 | 视觉学习者 |
| **env.example** | 环境变量模板 | 所有用户(必需) |

### 测试工具

| 文件名称 | 用途 | 使用方式 |
|---------|------|---------|
| **test_outlook_read.py** | 测试邮件读取 | `python test_outlook_read.py` |
| **test_outlook_send.py** | 测试邮件发送 | `python test_outlook_send.py` |
| **validate_config.py** | 完整配置验证 | `cd workflow-tools && python validate_config.py` |

### 项目文档

| 文档名称 | 用途 |
|---------|------|
| **README.md** | 项目总览和使用说明 |
| **config.py** | 配置文件(Python) |
| **.env** | 环境变量文件(需自己创建) |

---

## 🚀 配置流程建议

### 方案A: 快速配置 (推荐)

适合想要快速开始的用户:

```
1. 阅读: 快速开始.md (5分钟)
   ↓
2. 跟随步骤配置 (10分钟)
   ↓
3. 运行测试脚本验证
   ↓
4. 完成! ✅
```

### 方案B: 详细学习

适合想要深入了解的用户:

```
1. 阅读: 配置流程图.md (了解整体架构)
   ↓
2. 阅读: OUTLOOK_配置指南.md (详细步骤)
   ↓
3. 跟随步骤配置
   ↓
4. 运行测试脚本验证
   ↓
5. 阅读: README.md (了解更多功能)
   ↓
6. 完成! ✅
```

---

## 📋 配置步骤概览

### 第1步: Azure应用注册
- **文档**: OUTLOOK_配置指南.md → "步骤1"
- **所需时间**: 5分钟
- **获得**:
  - `OUTLOOK_CLIENT_ID`
  - `OUTLOOK_CLIENT_SECRET`
  - `OUTLOOK_TENANT_ID`

### 第2步: SMTP应用密码
- **文档**: OUTLOOK_配置指南.md → "步骤2"
- **所需时间**: 3分钟
- **获得**:
  - `OUTLOOK_SMTP_PASSWORD`

### 第3步: 环境变量配置
- **文档**: 快速开始.md → "第3步"
- **所需时间**: 2分钟
- **操作**:
  - 复制 `env.example` 为 `.env`
  - 填写所有凭据

### 第4步: 安装依赖
- **文档**: 快速开始.md → "第4步"
- **所需时间**: 3分钟
- **命令**:
  ```bash
  cd workflow-tools && pip install -e .[all]
  cd .. && pip install -r requirements.txt
  ```

### 第5步: 测试验证
- **文档**: 快速开始.md → "第5步"
- **所需时间**: 2分钟
- **命令**:
  ```bash
  python test_outlook_read.py
  python test_outlook_send.py
  ```

---

## 🔧 配置文件说明

### 必需创建的文件

```
.env                          # 环境变量配置文件
└─ 从 env.example 复制         # ⚠️ 不要直接编辑 env.example
```

### 自动生成的文件/目录

```
logs/                         # 日志文件目录
└─ workflow_YYYYMMDD.log      # 每日日志文件

history/                      # 历史记录目录
└─ history_YYYYMMDD_HHMMSS.json  # 执行历史记录

workflow-tools/workflow_tools.egg-info/  # 包信息(自动生成)
```

---

## 🛠️ 测试工具使用指南

### test_outlook_read.py - 邮件读取测试

**用途**: 验证Microsoft Graph API配置是否正确

**检查项目**:
- ✅ 环境变量是否完整
- ✅ 能否连接到Graph API
- ✅ 能否读取邮件列表

**运行方式**:
```bash
python test_outlook_read.py
```

**预期输出**:
```
[1/4] 加载环境变量...
✓ 环境变量加载完成

[2/4] 创建Outlook客户端...
✓ 客户端创建成功

[3/4] 连接到Microsoft Graph API...
✓ 连接成功!

[4/4] 获取最近5封邮件...
✓ 成功获取 5 封邮件

✓ 所有测试通过!
```

---

### test_outlook_send.py - 邮件发送测试

**用途**: 验证SMTP应用专用密码配置是否正确

**检查项目**:
- ✅ SMTP密码是否正确
- ✅ 能否连接到SMTP服务器
- ✅ 能否发送邮件

**运行方式**:
```bash
python test_outlook_send.py
```

**预期输出**:
```
[1/3] 加载环境变量...
✓ 环境变量加载完成

[2/3] 创建Outlook客户端...
✓ 客户端创建成功

[3/3] 发送测试邮件...
✓ 邮件发送成功!

请检查邮箱收件箱
```

---

### validate_config.py - 完整配置验证

**用途**: 一次性验证所有配置

**检查项目**:
- ✅ 所有环境变量
- ✅ Microsoft Graph API
- ✅ SMTP服务
- ✅ Gemini API (如果配置)

**运行方式**:
```bash
cd workflow-tools
python validate_config.py
```

---

## 🆘 故障排除

### 问题: 测试失败

**解决步骤**:

1. **检查环境变量**
   ```bash
   cat .env  # 查看配置文件
   ```

2. **查看详细文档**
   - 打开 `OUTLOOK_配置指南.md`
   - 跳转到 "常见问题" 章节

3. **查看日志**
   ```bash
   tail -f logs/workflow_$(date +%Y%m%d).log
   ```

4. **重新配置**
   - 如果Azure凭据错误,重新生成密钥
   - 如果SMTP密码错误,重新生成应用密码

---

## 📊 配置检查清单

使用此清单确认配置完整性:

### Azure配置
- [ ] Azure应用已注册
- [ ] Client ID已记录并填入.env
- [ ] Client Secret已记录并填入.env
- [ ] Tenant ID已记录并填入.env
- [ ] API权限Mail.Read已添加
- [ ] 管理员同意已授予

### SMTP配置
- [ ] 双重验证已启用
- [ ] SMTP应用密码已生成
- [ ] 密码已填入.env

### 环境配置
- [ ] .env文件已创建
- [ ] OUTLOOK_EMAIL已填写
- [ ] EMAIL_FILTER_SENDER已填写
- [ ] SUMMARY_RECIPIENT已填写
- [ ] GEMINI_API_KEY已填写(可选)

### 依赖安装
- [ ] workflow-tools已安装
- [ ] 主程序依赖已安装

### 测试验证
- [ ] test_outlook_read.py通过
- [ ] test_outlook_send.py通过
- [ ] 收到测试邮件

### 功能验证
- [ ] 主程序可以运行
- [ ] 日志文件正常生成
- [ ] 历史记录正常保存

---

## 🎓 学习资源

### 官方文档

- [Microsoft Graph API](https://docs.microsoft.com/en-us/graph/overview)
- [Azure应用注册](https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app)
- [Outlook SMTP设置](https://support.microsoft.com/en-us/office/pop-imap-and-smtp-settings-8361e398-8af4-4e97-b147-6c6c4ac95353)

### 项目文档

- [项目README](./README.md)
- [工作流工具文档](./workflow-tools/README.md)
- [Gemini模型配置](./workflow-tools/GEMINI_MODEL_CONFIG.md)

---

## 📞 获取帮助

### 问题排查顺序

1. **查看日志文件**
   ```bash
   ls -lt logs/ | head -3
   cat logs/最新的日志文件
   ```

2. **查看常见问题**
   - `OUTLOOK_配置指南.md` → "常见问题" 章节

3. **运行验证工具**
   ```bash
   cd workflow-tools
   python validate_config.py
   ```

4. **检查配置文件**
   ```bash
   cat .env | grep -v "^#"  # 显示所有非注释行
   ```

---

## ✅ 配置完成后

配置成功后,你可以:

1. **运行主程序**
   ```bash
   python main.py
   ```

2. **查看执行日志**
   ```bash
   tail -f logs/workflow_$(date +%Y%m%d).log
   ```

3. **查看历史记录**
   ```bash
   ls -lt history/
   ```

4. **自定义配置**
   - 编辑 `config.py` 修改行为
   - 调整定时任务时间
   - 修改AI分析提示词

---

## 🎉 祝配置顺利!

如有任何问题,请参考相应的文档或查看日志文件。

**记住: 永远不要将 .env 文件提交到Git仓库!** 🔒

