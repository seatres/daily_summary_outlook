# Azureåº”ç”¨ç¨‹åºæƒé™é…ç½®è¯¦è§£ ğŸ”‘

## ğŸ“‹ æ­£ç¡®çš„æƒé™åç§°

æ ¹æ®Microsoft Graphåº”ç”¨ç¨‹åºæƒé™åˆ—è¡¨,é‚®ä»¶ç›¸å…³æƒé™çš„**å‡†ç¡®åç§°**å¦‚ä¸‹:

### é‚®ä»¶æƒé™æ¸…å•

| æƒé™åç§° | æè¿° | æ˜¯å¦éœ€è¦ç®¡ç†å‘˜åŒæ„ | ç”¨é€” |
|---------|------|------------------|------|
| **Mail.Read** | Read mail in all mailboxes | âœ… æ˜¯ | **è¯»å–é‚®ä»¶(æ¨è)** |
| **Mail.ReadBasic** | Read basic mail in all mailboxes | âœ… æ˜¯ | è¯»å–åŸºæœ¬é‚®ä»¶ä¿¡æ¯ |
| **Mail.ReadBasic.All** | Read basic mail in all mailboxes | âœ… æ˜¯ | è¯»å–åŸºæœ¬é‚®ä»¶ä¿¡æ¯ |
| **Mail.ReadWrite** | Read and write mail in all mailboxes | âœ… æ˜¯ | è¯»å†™é‚®ä»¶(å¯é€‰) |
| **Mail.Send** | Send mail as any user | âœ… æ˜¯ | å‘é€é‚®ä»¶(ä¸éœ€è¦) |
| **Mail-Advanced.ReadWrite.All** | Read and write mail in all mailboxes, including modifying existing non-draft mails | âœ… æ˜¯ | é«˜çº§é‚®ä»¶æ“ä½œ |

---

## âœ… æœ¬é¡¹ç›®æ¨èé…ç½®

### æ–¹æ¡ˆ1: æœ€å°æƒé™(æ¨è) â­

ä»…æ·»åŠ ä¸€ä¸ªæƒé™:

```
æƒé™åç§°: Mail.Read
æè¿°: Read mail in all mailboxes
ç±»å‹: åº”ç”¨ç¨‹åºæƒé™
```

**ä¼˜ç‚¹**:
- âœ… æ»¡è¶³è¯»å–é‚®ä»¶çš„æ‰€æœ‰éœ€æ±‚
- âœ… éµå¾ªæœ€å°æƒé™åŸåˆ™
- âœ… å®‰å…¨æ€§æœ€é«˜

**ç¼ºç‚¹**:
- âŒ æ— æ³•æ ‡è®°é‚®ä»¶ä¸ºå·²è¯»
- âŒ æ— æ³•ä¿®æ”¹é‚®ä»¶å±æ€§

---

### æ–¹æ¡ˆ2: æ‰©å±•æƒé™(å¯é€‰)

å¦‚æœéœ€è¦æ›´å¤šåŠŸèƒ½,æ·»åŠ :

```
æƒé™1: Mail.Read
æè¿°: Read mail in all mailboxes
ç±»å‹: åº”ç”¨ç¨‹åºæƒé™

æƒé™2: Mail.ReadWrite
æè¿°: Read and write mail in all mailboxes  
ç±»å‹: åº”ç”¨ç¨‹åºæƒé™
```

**é¢å¤–åŠŸèƒ½**:
- âœ… å¯ä»¥æ ‡è®°é‚®ä»¶ä¸ºå·²è¯»
- âœ… å¯ä»¥ç§»åŠ¨é‚®ä»¶åˆ°å…¶ä»–æ–‡ä»¶å¤¹
- âœ… å¯ä»¥ä¿®æ”¹é‚®ä»¶å…ƒæ•°æ®

---

## ğŸ” åœ¨Azureé—¨æˆ·ä¸­æŸ¥æ‰¾æƒé™

### æ­¥éª¤1: è¿›å…¥APIæƒé™é¡µé¢

1. æ‰“å¼€Azure Portal: https://portal.azure.com/
2. è¿›å…¥ **åº”ç”¨æ³¨å†Œ** â†’ é€‰æ‹©ä½ çš„åº”ç”¨
3. ç‚¹å‡»å·¦ä¾§ **APIæƒé™**
4. ç‚¹å‡» **+ æ·»åŠ æƒé™**

### æ­¥éª¤2: é€‰æ‹©Microsoft Graph

1. åœ¨æƒé™é€‰æ‹©ç•Œé¢,ç‚¹å‡» **Microsoft Graph**
2. é€‰æ‹© **åº”ç”¨ç¨‹åºæƒé™** (Application permissions)
   - âš ï¸ **ä¸æ˜¯** "å§”æ‰˜æƒé™" (Delegated permissions)

### æ­¥éª¤3: æœç´¢é‚®ä»¶æƒé™

åœ¨æœç´¢æ¡†ä¸­è¾“å…¥: **`mail`**

ä½ ä¼šçœ‹åˆ°å¦‚ä¸‹æƒé™åˆ—è¡¨:

```
ğŸ“§ Mail
  â”œâ”€ Mail.Read                          åº”ç”¨ç¨‹åºæƒé™
  â”œâ”€ Mail.ReadBasic                     åº”ç”¨ç¨‹åºæƒé™
  â”œâ”€ Mail.ReadBasic.All                 åº”ç”¨ç¨‹åºæƒé™
  â”œâ”€ Mail.ReadWrite                     åº”ç”¨ç¨‹åºæƒé™
  â””â”€ Mail.Send                          åº”ç”¨ç¨‹åºæƒé™

ğŸ“§ Mail-Advanced
  â””â”€ Mail-Advanced.ReadWrite.All        åº”ç”¨ç¨‹åºæƒé™

ğŸ“§ MailboxFolder
  â”œâ”€ MailboxFolder.Read.All             åº”ç”¨ç¨‹åºæƒé™
  â””â”€ MailboxFolder.ReadWrite.All        åº”ç”¨ç¨‹åºæƒé™

ğŸ“§ MailboxItem
  â”œâ”€ MailboxItem.ImportExport.All       åº”ç”¨ç¨‹åºæƒé™
  â””â”€ MailboxItem.Read.All               åº”ç”¨ç¨‹åºæƒé™

ğŸ“§ MailboxSettings
  â”œâ”€ MailboxSettings.Read               åº”ç”¨ç¨‹åºæƒé™
  â””â”€ MailboxSettings.ReadWrite          åº”ç”¨ç¨‹åºæƒé™
```

### æ­¥éª¤4: é€‰æ‹©å¹¶æ·»åŠ 

1. **å±•å¼€ "Mail" åˆ†ç»„**
2. **å‹¾é€‰** `Mail.Read` å·¦ä¾§çš„å¤é€‰æ¡†
3. (å¯é€‰) å¦‚æœéœ€è¦å†™æƒé™,ä¹Ÿå‹¾é€‰ `Mail.ReadWrite`
4. ç‚¹å‡»åº•éƒ¨çš„ **æ·»åŠ æƒé™** æŒ‰é’®

### æ­¥éª¤5: æˆäºˆç®¡ç†å‘˜åŒæ„

âš ï¸ **è¿™æ˜¯æœ€å…³é”®çš„ä¸€æ­¥!**

1. åœ¨ "APIæƒé™" é¡µé¢,æ‰¾åˆ°åˆšæ·»åŠ çš„æƒé™
2. ç‚¹å‡» **"ä¸º [ç»„ç»‡åç§°] æˆäºˆç®¡ç†å‘˜åŒæ„"**
3. åœ¨å¼¹å‡ºå¯¹è¯æ¡†ä¸­ç‚¹å‡» **"æ˜¯"**
4. ç­‰å¾…çŠ¶æ€åˆ—æ˜¾ç¤º: **"âœ“ å·²æˆäºˆç®¡ç†å‘˜åŒæ„"**

---

## ğŸ¯ é…ç½®å®Œæˆåçš„éªŒè¯

### æ­£ç¡®çš„é…ç½®åº”è¯¥æ˜¾ç¤º:

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    å·²é…ç½®çš„æƒé™                            â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ æƒé™åç§°          â•‘ ç±»å‹      â•‘ çŠ¶æ€                      â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ Mail.Read         â•‘ åº”ç”¨ç¨‹åº  â•‘ âœ“ å·²æˆäºˆç®¡ç†å‘˜åŒæ„         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

å¦‚æœæ·»åŠ äº†å¯é€‰çš„å†™æƒé™:

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    å·²é…ç½®çš„æƒé™                            â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ æƒé™åç§°          â•‘ ç±»å‹      â•‘ çŠ¶æ€                      â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ Mail.Read         â•‘ åº”ç”¨ç¨‹åº  â•‘ âœ“ å·²æˆäºˆç®¡ç†å‘˜åŒæ„         â•‘
â•‘ Mail.ReadWrite    â•‘ åº”ç”¨ç¨‹åº  â•‘ âœ“ å·²æˆäºˆç®¡ç†å‘˜åŒæ„         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## âš ï¸ å¸¸è§é”™è¯¯

### é”™è¯¯1: é€‰æ‹©äº†å§”æ‰˜æƒé™

**ç—‡çŠ¶**:
```
æƒé™ç±»å‹æ˜¾ç¤º: "å§”æ‰˜" è€Œä¸æ˜¯ "åº”ç”¨ç¨‹åº"
```

**è§£å†³æ–¹æ¡ˆ**:
1. åˆ é™¤è¯¥æƒé™
2. é‡æ–°æ·»åŠ æ—¶é€‰æ‹© **"åº”ç”¨ç¨‹åºæƒé™"**

---

### é”™è¯¯2: æœªæˆäºˆç®¡ç†å‘˜åŒæ„

**ç—‡çŠ¶**:
```
çŠ¶æ€åˆ—æ˜¾ç¤º: "æœªæˆäºˆåŒæ„" æˆ–ç©ºç™½
```

**è§£å†³æ–¹æ¡ˆ**:
1. ç‚¹å‡» "ä¸º [ç»„ç»‡] æˆäºˆç®¡ç†å‘˜åŒæ„"
2. å¦‚æœæŒ‰é’®æ˜¯ç°è‰²çš„,è¯´æ˜ä½ æ²¡æœ‰ç®¡ç†å‘˜æƒé™
3. è”ç³»ITç®¡ç†å‘˜å¸®åŠ©æˆäºˆ

---

### é”™è¯¯3: æ‰¾ä¸åˆ°Mail.Readæƒé™

**ç—‡çŠ¶**:
```
æœç´¢æ¡†è¾“å…¥åæ‰¾ä¸åˆ°æƒé™
```

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®è®¤é€‰æ‹©çš„æ˜¯ **"åº”ç”¨ç¨‹åºæƒé™"** è€Œä¸æ˜¯ "å§”æ‰˜æƒé™"
2. å°è¯•å±•å¼€ "Mail" åˆ†ç»„
3. å‘ä¸‹æ»šåŠ¨æŸ¥çœ‹å®Œæ•´åˆ—è¡¨

---

## ğŸ“Š æƒé™å¯¹æ¯”è¡¨

### Mail.Read vs Mail.ReadWrite

| æ“ä½œ | Mail.Read | Mail.ReadWrite |
|------|-----------|----------------|
| è¯»å–é‚®ä»¶åˆ—è¡¨ | âœ… | âœ… |
| è¯»å–é‚®ä»¶å†…å®¹ | âœ… | âœ… |
| è¯»å–é‚®ä»¶é™„ä»¶ | âœ… | âœ… |
| ç­›é€‰é‚®ä»¶ | âœ… | âœ… |
| æ ‡è®°å·²è¯»/æœªè¯» | âŒ | âœ… |
| ç§»åŠ¨é‚®ä»¶ | âŒ | âœ… |
| åˆ é™¤é‚®ä»¶ | âŒ | âœ… |
| åˆ›å»ºè‰ç¨¿ | âŒ | âœ… |
| å‘é€é‚®ä»¶ | âŒ | âŒ* |

*æ³¨: å‘é€é‚®ä»¶éœ€è¦ `Mail.Send` æƒé™,ä½†æœ¬é¡¹ç›®ä½¿ç”¨SMTPå‘é€,ä¸éœ€è¦æ­¤æƒé™

---

## ğŸ” å®‰å…¨æœ€ä½³å®è·µ

### 1. ä½¿ç”¨æœ€å°æƒé™åŸåˆ™

```
âœ… æ¨è: åªæ·»åŠ  Mail.Read
âŒ é¿å…: æ·»åŠ ä¸å¿…è¦çš„æƒé™å¦‚ Mail.Send
```

### 2. å®šæœŸå®¡æŸ¥æƒé™

æ¯3-6ä¸ªæœˆæ£€æŸ¥ä¸€æ¬¡:
- æ˜¯å¦æœ‰ä¸å†ä½¿ç”¨çš„æƒé™
- æ˜¯å¦æœ‰è¿‡åº¦æˆæƒçš„æƒ…å†µ

### 3. ä¿æŠ¤å¯†é’¥å®‰å…¨

```bash
# âœ… æ­£ç¡®: ä½¿ç”¨ç¯å¢ƒå˜é‡
OUTLOOK_CLIENT_SECRET=your_secret

# âŒ é”™è¯¯: ç¡¬ç¼–ç åœ¨ä»£ç ä¸­
client_secret = "abc123..."
```

### 4. ç›‘æ§APIä½¿ç”¨

åœ¨Azure Portalä¸­ç›‘æ§:
- APIè°ƒç”¨é¢‘ç‡
- æ˜¯å¦æœ‰å¼‚å¸¸è®¿é—®
- æƒé™ä½¿ç”¨æƒ…å†µ

---

## ğŸ§ª æµ‹è¯•æƒé™é…ç½®

### æ–¹æ³•1: ä½¿ç”¨é¡¹ç›®æµ‹è¯•è„šæœ¬

```bash
python test_outlook_read.py
```

**é¢„æœŸè¾“å‡º**:
```
[3/4] è¿æ¥åˆ°Microsoft Graph API...
âœ“ è¿æ¥æˆåŠŸ!

[4/4] è·å–æœ€è¿‘5å°é‚®ä»¶...
âœ“ æˆåŠŸè·å– 5 å°é‚®ä»¶
```

### æ–¹æ³•2: ä½¿ç”¨Microsoft Graph Explorer

1. è®¿é—®: https://developer.microsoft.com/graph/graph-explorer
2. ç™»å½•ä½ çš„è´¦å·
3. å°è¯•æ‰§è¡ŒæŸ¥è¯¢:
   ```
   GET https://graph.microsoft.com/v1.0/me/messages
   ```

---

## ğŸ“š å‚è€ƒæ–‡æ¡£

### Microsoftå®˜æ–¹æ–‡æ¡£

- [Mail permissions (Application)](https://learn.microsoft.com/en-us/graph/permissions-reference#mail-permissions)
- [Application permissions overview](https://learn.microsoft.com/en-us/graph/auth/auth-concepts#microsoft-graph-permissions)
- [Grant admin consent](https://learn.microsoft.com/en-us/graph/auth-v2-service)

### Graph APIç«¯ç‚¹

```
# è¯»å–é‚®ä»¶åˆ—è¡¨
GET https://graph.microsoft.com/v1.0/users/{user-id}/messages

# è¯»å–ç‰¹å®šé‚®ä»¶
GET https://graph.microsoft.com/v1.0/users/{user-id}/messages/{message-id}

# ç­›é€‰é‚®ä»¶
GET https://graph.microsoft.com/v1.0/users/{user-id}/messages?$filter=subject eq 'æ¯æ—¥æ€»ç»“'
```

---

## âœ… é…ç½®æ£€æŸ¥æ¸…å•

å®Œæˆæƒé™é…ç½®å,ä½¿ç”¨æ­¤æ¸…å•ç¡®è®¤:

- [ ] å·²é€‰æ‹© **"åº”ç”¨ç¨‹åºæƒé™"** (ä¸æ˜¯å§”æ‰˜æƒé™)
- [ ] å·²æ·»åŠ  **`Mail.Read`** æƒé™
- [ ] æƒé™ç±»å‹æ˜¾ç¤ºä¸º **"åº”ç”¨ç¨‹åº"**
- [ ] çŠ¶æ€æ˜¾ç¤ºä¸º **"âœ“ å·²æˆäºˆç®¡ç†å‘˜åŒæ„"**
- [ ] å·²è®°å½• Client IDã€Tenant IDã€Client Secret
- [ ] å®¢æˆ·ç«¯å¯†é’¥æœªè¿‡æœŸ
- [ ] æµ‹è¯•è„šæœ¬è¿è¡ŒæˆåŠŸ

---

## ğŸ‰ æ€»ç»“

### æœ¬é¡¹ç›®éœ€è¦çš„æƒé™(æœ€ç®€é…ç½®):

```
æƒé™åç§°: Mail.Read
æè¿°: Read mail in all mailboxes
ç±»å‹: åº”ç”¨ç¨‹åºæƒé™
çŠ¶æ€: å·²æˆäºˆç®¡ç†å‘˜åŒæ„
```

è¿™ä¸ªæƒé™å°±è¶³å¤Ÿå®Œæˆæ‰€æœ‰é‚®ä»¶è¯»å–ä»»åŠ¡äº†!

### å…³é”®è¦ç‚¹:

1. âœ… æƒé™åç§°æ˜¯ **`Mail.Read`** (ä¸æ˜¯ `Mail.Read.All`)
2. âœ… å¿…é¡»é€‰æ‹© **"åº”ç”¨ç¨‹åºæƒé™"**
3. âœ… å¿…é¡» **æˆäºˆç®¡ç†å‘˜åŒæ„**
4. âœ… åœ¨æœç´¢æ¡†è¾“å…¥ **"mail"** å¯ä»¥æ‰¾åˆ°

---

ç¥é…ç½®é¡ºåˆ©! ğŸŠ

å¦‚æœ‰é—®é¢˜,è¯·æŸ¥çœ‹ä¸»é…ç½®æ–‡æ¡£: `OUTLOOK_é…ç½®æŒ‡å—.md`

